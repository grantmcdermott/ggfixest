<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregates event-study treatment effects. — aggr_es • ggfixest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregates event-study treatment effects. — aggr_es"><meta name="description" content='Aggregates post- (and/or pre-) treatment effects of an
"event-study" estimation, also known as a dynamic difference-in-differences
(DDiD) model. The event-study should have been estimated using the fixest
package, which provides a specialised i() operator for this class
of models. By default, the function will return the average post-treatment
effect (i.e. across multiple periods). However, it can also return the
cumulative post-treatment effect and can be used to aggregate pre-treatment
effects too. At its heart, aggr_es() is a convenience wrapper around
marginaleffects::hypotheses(), which is used to perform the underlying
joint hypothesis test.'><meta property="og:description" content='Aggregates post- (and/or pre-) treatment effects of an
"event-study" estimation, also known as a dynamic difference-in-differences
(DDiD) model. The event-study should have been estimated using the fixest
package, which provides a specialised i() operator for this class
of models. By default, the function will return the average post-treatment
effect (i.e. across multiple periods). However, it can also return the
cumulative post-treatment effect and can be used to aggregate pre-treatment
effects too. At its heart, aggr_es() is a convenience wrapper around
marginaleffects::hypotheses(), which is used to perform the underlying
joint hypothesis test.'><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggfixest</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/ggiplot.html">Comparing ggiplot to iplot</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/grantmcdermott/ggfixest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregates event-study treatment effects.</h1>
      <small class="dont-index">Source: <a href="https://github.com/grantmcdermott/ggfixest/blob/main/R/aggr_es.R" class="external-link"><code>R/aggr_es.R</code></a></small>
      <div class="d-none name"><code>aggr_es.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregates post- (and/or pre-) treatment effects of an
"event-study" estimation, also known as a dynamic difference-in-differences
(DDiD) model. The event-study should have been estimated using the <code>fixest</code>
package, which provides a specialised <code><a href="https://lrberge.github.io/fixest/reference/i.html" class="external-link">i()</a></code> operator for this class
of models. By default, the function will return the average post-treatment
effect (i.e. across multiple periods). However, it can also return the
cumulative post-treatment effect and can be used to aggregate pre-treatment
effects too. At its heart, <code>aggr_es()</code> is a convenience wrapper around
<code><a href="https://rdrr.io/pkg/marginaleffects/man/hypotheses.html" class="external-link">marginaleffects::hypotheses()</a></code>, which is used to perform the underlying
joint hypothesis test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggr_es</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  rhs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  period <span class="op">=</span> <span class="st">"post"</span>,</span>
<span>  aggregation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"cumulative"</span><span class="op">)</span>,</span>
<span>  abbr_term <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A model object of class <code>fixest</code>, where the <code><a href="https://lrberge.github.io/fixest/reference/i.html" class="external-link">i()</a></code> operator has
been used to facilitate an "event-study" DiD design. See Examples.</p></dd>


<dt id="arg-rhs">rhs<a class="anchor" aria-label="anchor" href="#arg-rhs"></a></dt>
<dd><p>Numeric. The null hypothesis value. Defaults to 0.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>Keyword string or numeric sequence. Which group of periods
are we aggregating? Can either be one of three convenience strings—i.e.,
"post" (the default), "prep", or "both"—or a numeric sequence that matches
a subset of periods in the data (e.g. 6:8).</p></dd>


<dt id="arg-aggregation">aggregation<a class="anchor" aria-label="anchor" href="#arg-aggregation"></a></dt>
<dd><p>Character string. The aggregation type. Either "mean" (the
default) or "cumulative".</p></dd>


<dt id="arg-abbr-term">abbr_term<a class="anchor" aria-label="anchor" href="#arg-abbr-term"></a></dt>
<dd><p>Logical. Should the leading "term" column of the return
data frame be abbreviated? The default is TRUE. If FALSE, then the term
column will retain the full hypothesis test string as per usual with
<code>marginaleffects()</code>. Note that this information is retained as an attribute
of the return object, regardless.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/marginaleffects/man/hypotheses.html" class="external-link">marginaleffects::hypotheses()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A "tidy" data frame of aggregated (pre and/or post) treatment
effects, plus inferential information about standard errors, confidence
intervals, etc. Potentially useful information about the underlying
hypothesis test is also provided as an attribute. See Examples.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/marginaleffects/man/hypotheses.html" class="external-link">marginaleffects::hypotheses()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grantmcdermott.com/ggfixest/" class="external-link">ggfixest</a></span><span class="op">)</span> <span class="co">## Will load fixest too</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">=</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/i.html" class="external-link">i</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">treat</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span> <span class="op">+</span> <span class="va">period</span>, <span class="va">base_did</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default hypothesis test is a null mean post-treatment effect</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">post_mean</span> <span class="op">=</span> <span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     term estimate std.error statistic      p.value s.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   &lt;char&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;        &lt;num&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: post-treatment (mean) 3.906554 0.8598576  4.543257 5.539159e-06 17.4619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 2.221264  5.591844</span>
<span class="r-in"><span><span class="co"># The underlying hypothesis is saved as an attribute</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">post_mean</span><span class="op">)</span><span class="op">[</span><span class="st">"hypothesis"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $&lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Other hypothesis and aggregation options</span></span></span>
<span class="r-in"><span><span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span>, aggregation <span class="op">=</span> <span class="st">"cumulative"</span><span class="op">)</span> <span class="co"># cumulative instead of mean effects</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           term estimate std.error statistic      p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         &lt;char&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: post-treatment (cumulative) 19.53277  4.299288  4.543257 5.539158e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    s.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;num&gt;    &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 17.4619 11.10632  27.95922</span>
<span class="r-in"><span><span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span>, period <span class="op">=</span> <span class="st">"pre"</span><span class="op">)</span>             <span class="co"># pre period instead of post</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    term  estimate std.error statistic   p.value  s.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  &lt;char&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: pre-treatment (mean) -1.179871 0.8561964 -1.378037 0.1681917 2.571821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: -2.857985 0.4982434</span>
<span class="r-in"><span><span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span>, period <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>            <span class="co"># pre &amp; post periods separately</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     term  estimate std.error statistic      p.value   s.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   &lt;char&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;        &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  pre-treatment (mean) -1.179871 0.8561964 -1.378037 1.681917e-01  2.571821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: post-treatment (mean)  3.906554 0.8598576  4.543257 5.539159e-06 17.461902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: -2.857985 0.4982434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  2.221264 5.5918440</span>
<span class="r-in"><span><span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span>, period <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>               <span class="co"># specific subset of periods</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           term estimate std.error statistic     p.value s.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         &lt;char&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;       &lt;num&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: periods6:8-treatment (mean) 2.731705 0.9299503  2.937474 0.003308975  8.2394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 0.9090361  4.554374</span>
<span class="r-in"><span><span class="fu">aggr_es</span><span class="op">(</span><span class="va">est</span>, rhs <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, period <span class="op">=</span> <span class="st">"pre"</span><span class="op">)</span>   <span class="co"># pre period with H0 value of 1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    term   estimate std.error  statistic   p.value   s.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  &lt;char&gt;      &lt;num&gt;     &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: pre-treatment (mean) -0.1798707 0.8561964 -0.2100811 0.8336044 0.2625653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: -1.857985  1.498243</span>
<span class="r-in"><span><span class="co"># Etc.</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Grant McDermott.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

